{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final##TkutfpzA","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"customer_payments##sYuVfFza":{"id":"customer_payments##sYuVfFza","component":"SQLStatement","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY customer_id\n"}]},"ports":{"inputs":[{"id":"WMjWpAm8","slug":"payments"},{"id":"yjviqMD4","slug":"orders"}],"outputs":[{"id":"qW8aIN6s","slug":"out"}],"isCustomOutputSchema":false}},"customers##LewlL06V":{"id":"customers##LewlL06V","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"NKSwL1mR","slug":"out"}],"isCustomOutputSchema":false}},"final##TkutfpzA":{"id":"final##TkutfpzA","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"Gk2mqB3d","slug":"customers"},{"id":"iRZb5rqP","slug":"customer_orders"},{"id":"p12HP4xU","slug":"customer_payments"}],"outputs":[{"id":"vdGuU6ai","slug":"out"}],"isCustomOutputSchema":false}},"orders##XzKu6ZfK":{"id":"orders##XzKu6ZfK","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"FAZPFBou","slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##UmSaP9ct":{"id":"customer_orders##UmSaP9ct","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"gPPJOluI","slug":"orders"}],"outputs":[{"id":"ncyNA3EC","slug":"out"}],"isCustomOutputSchema":false}},"payments##MFU9jdju":{"id":"payments##MFU9jdju","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"QHIFXC5p","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"MgHX7ptf","source":"orders##XzKu6ZfK","sourcePort":"FAZPFBou","target":"customer_orders##UmSaP9ct","targetPort":"gPPJOluI"},{"id":"RplL6HX0","source":"payments##MFU9jdju","sourcePort":"QHIFXC5p","target":"customer_payments##sYuVfFza","targetPort":"WMjWpAm8"},{"id":"RIBvW0Jd","source":"orders##XzKu6ZfK","sourcePort":"FAZPFBou","target":"customer_payments##sYuVfFza","targetPort":"yjviqMD4"},{"id":"vHgNFn9u","source":"customers##LewlL06V","sourcePort":"NKSwL1mR","target":"final##TkutfpzA","targetPort":"Gk2mqB3d"},{"id":"jqS0wL01","source":"customer_orders##UmSaP9ct","sourcePort":"ncyNA3EC","target":"final##TkutfpzA","targetPort":"iRZb5rqP"},{"id":"qgJCoZHX","source":"customer_payments##sYuVfFza","sourcePort":"qW8aIN6s","target":"final##TkutfpzA","targetPort":"p12HP4xU"}],"component":"Model"}