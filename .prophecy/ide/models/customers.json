{"id":"customers","metainfo":{"label":"customers","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"payments##ccAik3iQ":{"id":"payments##ccAik3iQ","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"uyrLVUCH","slug":"out"}],"isCustomOutputSchema":false}},"final##r2XJNgj2":{"id":"final##r2XJNgj2","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"SvhiPEjt","slug":"customers"},{"id":"Qqpnpooz","slug":"customer_orders"},{"id":"k45QYXjH","slug":"customer_payments"}],"outputs":[{"id":"RddOthNK","slug":"out"}],"isCustomOutputSchema":false}},"customers##PJfJI7FS":{"id":"customers##PJfJI7FS","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"LnWHjIiZ","slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##urZr3JIq":{"id":"customer_orders##urZr3JIq","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"NdRs0EDV","slug":"orders"}],"outputs":[{"id":"gJlv92Pp","slug":"out"}],"isCustomOutputSchema":false}},"customers##fPcKUatG":{"id":"customers##fPcKUatG","component":"TargetModel","metadata":{"label":"customers","phase":0,"macroDependencies":[]},"properties":{"customQueryDisabled":true,"customQuery":false,"incrementalEditorDisabled":true,"query":"SELECT * \n\nFROM final\n","incrementalKey":false,"incremental":{"expression":"true"}},"ports":{"inputs":[{"id":"TRrKElLj","slug":"final"}],"outputs":[{"id":"APMV8mnc","slug":"out"}],"isCustomOutputSchema":false}},"orders##djdz7cLz":{"id":"orders##djdz7cLz","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"fPvdhZ1M","slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##c5deU0aw":{"id":"customer_payments##c5deU0aw","component":"SQLStatement","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY customer_id\n"}]},"ports":{"inputs":[{"id":"DCFepkWf","slug":"payments"},{"id":"ntaCSu2d","slug":"orders"}],"outputs":[{"id":"F5bk9LXp","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"h8aEIGph","source":"orders##djdz7cLz","sourcePort":"fPvdhZ1M","target":"customer_orders##urZr3JIq","targetPort":"NdRs0EDV"},{"id":"nazIj4sZ","source":"payments##ccAik3iQ","sourcePort":"uyrLVUCH","target":"customer_payments##c5deU0aw","targetPort":"DCFepkWf"},{"id":"XuIGyzq5","source":"orders##djdz7cLz","sourcePort":"fPvdhZ1M","target":"customer_payments##c5deU0aw","targetPort":"ntaCSu2d"},{"id":"dHugfr3S","source":"customers##PJfJI7FS","sourcePort":"LnWHjIiZ","target":"final##r2XJNgj2","targetPort":"SvhiPEjt"},{"id":"Mavli8YZ","source":"customer_orders##urZr3JIq","sourcePort":"gJlv92Pp","target":"final##r2XJNgj2","targetPort":"Qqpnpooz"},{"id":"uARE9DD5","source":"customer_payments##c5deU0aw","sourcePort":"F5bk9LXp","target":"final##r2XJNgj2","targetPort":"k45QYXjH"},{"id":"cQQj0VqZ","source":"final##r2XJNgj2","sourcePort":"RddOthNK","target":"customers##fPcKUatG","targetPort":"TRrKElLj"}],"component":"Model"}