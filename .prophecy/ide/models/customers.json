{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final##XwgZAzlZ","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"payments##nt0yDWJI":{"id":"payments##nt0yDWJI","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"gEf6FJJ6","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final##XwgZAzlZ":{"id":"final##XwgZAzlZ","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"EXaA146I","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"customers"},{"id":"t7B9gN7j","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"customer_orders"},{"id":"tZdKhCtb","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"customer_payments"}],"outputs":[{"id":"SMeMutO5","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"orders##sbg88xQh":{"id":"orders##sbg88xQh","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"mrhZtxuu","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##G7qWDQeo":{"id":"customer_payments##G7qWDQeo","component":"SQLStatement","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY customer_id\n"}]},"ports":{"inputs":[{"id":"cell0APt","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"payments"},{"id":"pxFGVogT","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"lHsagziw","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customers##tGJxzqJr":{"id":"customers##tGJxzqJr","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"GAWBwe5Q","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##YlPHNFWJ":{"id":"customer_orders##YlPHNFWJ","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"s3JV3mE2","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"P1FnJlQV","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"JSX7X9m5","source":"orders##sbg88xQh","sourcePort":"mrhZtxuu","target":"customer_orders##YlPHNFWJ","targetPort":"s3JV3mE2"},{"id":"LNTWlinn","source":"payments##nt0yDWJI","sourcePort":"gEf6FJJ6","target":"customer_payments##G7qWDQeo","targetPort":"cell0APt"},{"id":"u9jzAe2z","source":"orders##sbg88xQh","sourcePort":"mrhZtxuu","target":"customer_payments##G7qWDQeo","targetPort":"pxFGVogT"},{"id":"ppHIDmHB","source":"customers##tGJxzqJr","sourcePort":"GAWBwe5Q","target":"final##XwgZAzlZ","targetPort":"EXaA146I"},{"id":"FaTUiBhz","source":"customer_orders##YlPHNFWJ","sourcePort":"P1FnJlQV","target":"final##XwgZAzlZ","targetPort":"t7B9gN7j"},{"id":"ePIB1kh1","source":"customer_payments##G7qWDQeo","sourcePort":"lHsagziw","target":"final##XwgZAzlZ","targetPort":"tZdKhCtb"}],"component":"Model"}