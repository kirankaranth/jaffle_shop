{"id":"customers","metainfo":{"label":"customers","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"customer_payments##jCLZwVxq":{"id":"customer_payments##jCLZwVxq","component":"SQLStatement","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY customer_id\n"}]},"ports":{"inputs":[{"id":"PQRETLHg","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"payments"},{"id":"DcmJjjmH","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"oClDepEQ","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customers##X75k74JB":{"id":"customers##X75k74JB","component":"TargetModel","metadata":{"label":"customers","phase":0,"macroDependencies":[]},"properties":{"customQueryDisabled":true,"customQuery":false,"incrementalEditorDisabled":true,"query":"SELECT * \n\nFROM final\n","incrementalKey":false,"incremental":{"expression":"true"}},"ports":{"inputs":[{"id":"eZDugP4x","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"final"}],"outputs":[{"id":"kslMcozP","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customers##mgNGRKsW":{"id":"customers##mgNGRKsW","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"ZakOXkSh","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##QR6D9fdu":{"id":"customer_orders##QR6D9fdu","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"R5PRQPC7","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"c5nXiA2i","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"orders##eDvrPYE0":{"id":"orders##eDvrPYE0","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"wLGsPejt","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final##b1u6N3rN":{"id":"final##b1u6N3rN","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"YjrZ0MRS","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"customers"},{"id":"Fj87Rz5u","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"customer_orders"},{"id":"KZByDVkv","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"customer_payments"}],"outputs":[{"id":"TMsZt6WT","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"payments##yvTZTOKO":{"id":"payments##yvTZTOKO","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"lrq2JAYf","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"hJg4s0x9","source":"orders##eDvrPYE0","sourcePort":"wLGsPejt","target":"customer_orders##QR6D9fdu","targetPort":"R5PRQPC7"},{"id":"U46zFuYS","source":"payments##yvTZTOKO","sourcePort":"lrq2JAYf","target":"customer_payments##jCLZwVxq","targetPort":"PQRETLHg"},{"id":"TZMQBtSS","source":"orders##eDvrPYE0","sourcePort":"wLGsPejt","target":"customer_payments##jCLZwVxq","targetPort":"DcmJjjmH"},{"id":"z6aeFrjm","source":"customers##mgNGRKsW","sourcePort":"ZakOXkSh","target":"final##b1u6N3rN","targetPort":"YjrZ0MRS"},{"id":"bz0Y45Wa","source":"customer_orders##QR6D9fdu","sourcePort":"c5nXiA2i","target":"final##b1u6N3rN","targetPort":"Fj87Rz5u"},{"id":"S20Y8gkY","source":"customer_payments##jCLZwVxq","sourcePort":"oClDepEQ","target":"final##b1u6N3rN","targetPort":"KZByDVkv"},{"id":"pqQ66Llk","source":"final##b1u6N3rN","sourcePort":"TMsZt6WT","target":"customers##X75k74JB","targetPort":"eZDugP4x"}],"component":"Model"}